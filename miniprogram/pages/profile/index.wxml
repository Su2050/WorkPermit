<!--pages/profile/index.wxml-->
<view class="page">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view wx:if="{{!isLoggedIn}}" class="not-logged-in container">
    <view class="empty-state">
      <image class="empty-icon" src="/assets/images/profile.png" mode="aspectFit" />
      <text class="empty-text">è¯·å…ˆç™»å½•</text>
    </view>
    <button class="btn btn-primary btn-block" bindtap="goLogin">
      ç«‹å³ç™»å½•
    </button>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else class="container">
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <view class="user-card card">
      <view class="user-avatar">
        <text class="avatar-text">{{workerInfo.name[0] || 'U'}}</text>
      </view>
      <view class="user-info">
        <text class="user-name">{{workerInfo.name}}</text>
        <text class="user-contractor">{{workerInfo.contractor_name}}</text>
      </view>
    </view>

    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-card card">
      <view class="stat-item">
        <text class="stat-value">{{stats.totalTrainings}}</text>
        <text class="stat-label">åŸ¹è®­æ€»æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value text-success">{{stats.completedTrainings}}</text>
        <text class="stat-label">å®Œæˆæ•°é‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{stats.totalWatchTime}}</text>
        <text class="stat-label">å­¦ä¹ æ—¶é•¿(åˆ†)</text>
      </view>
    </view>

    <!-- èœå•åˆ—è¡¨ -->
    <view class="menu-card card">
      <view class="menu-item" bindtap="goHistory">
        <view class="menu-left">
          <text class="menu-icon">ğŸ“š</text>
          <text class="menu-text">åŸ¹è®­å†å²</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" bindtap="goNotifications">
        <view class="menu-left">
          <text class="menu-icon">ğŸ””</text>
          <text class="menu-text">æ¶ˆæ¯é€šçŸ¥</text>
        </view>
        <view class="menu-right">
          <view wx:if="{{unreadCount}}" class="badge">{{unreadCount}}</view>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- é€€å‡ºç™»å½• -->
    <button class="btn btn-secondary btn-block logout-btn" bindtap="logout">
      é€€å‡ºç™»å½•
    </button>
  </view>
</view>

