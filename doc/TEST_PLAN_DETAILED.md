# 作业票管理系统 - 详细测试方案

**版本**: v2.0  
**创建日期**: 2026-01-10  
**最后更新**: 2026-01-10

---

## 目录

1. [测试概述](#1-测试概述)
2. [测试环境](#2-测试环境)
3. [测试数据准备](#3-测试数据准备)
4. [详细测试用例](#4-详细测试用例)
5. [测试执行计划](#5-测试执行计划)
6. [测试报告模板](#6-测试报告模板)

---

## 1. 测试概述

### 1.1 测试目标
- 验证系统功能是否符合需求
- 确保前后端接口一致性
- 验证数据正确性和完整性
- 确保系统稳定性和性能

### 1.2 测试范围
- 后端API功能测试
- 前端功能测试
- 前后端集成测试
- 数据一致性测试
- 异常场景测试

### 1.3 测试策略
- **单元测试**: 覆盖所有API端点
- **集成测试**: 验证前后端交互
- **功能测试**: 验证业务流程
- **异常测试**: 验证错误处理

---

## 2. 测试环境

### 2.1 环境配置
- **后端地址**: http://localhost:8000
- **前端地址**: http://localhost:5173
- **数据库**: PostgreSQL (Docker)
- **Redis**: Redis (Docker)

### 2.2 测试账号
- **管理员账号**: 
  - 用户名: `admin`
  - 密码: `admin123`
  - 角色: `SysAdmin`

---

## 3. 测试数据准备

### 3.1 基础数据
通过 `backend/scripts/init_demo_data.py` 初始化：
- 1个工地 (Site)
- 3个施工单位 (Contractor)
- 10个作业票 (WorkTicket)
- 20个作业区域 (WorkArea)
- 10个培训视频 (TrainingVideo)
- 200个作业人员 (Worker)

### 3.2 测试数据标识
- 测试作业票: "A区焊接作业许可"
- 测试施工单位: "建设工程集团有限公司"
- 测试区域: "焊接区A"

---

## 4. 详细测试用例

## 4.1 认证授权模块

### TC-AUTH-001: 用户登录成功
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 用户账号已存在
- 后端服务正常运行

**测试步骤**:
1. 发送POST请求到 `/api/admin/auth/login`
2. 请求体: `{"username": "admin", "password": "admin123"}`
3. 检查响应状态码

**预期结果**:
- HTTP状态码: 200
- 响应格式: `{"code": 0, "message": "success", "data": {...}}`
- `data.access_token` 存在且不为空
- `data.token_type` 等于 "bearer"

**测试数据**:
```json
{
  "username": "admin",
  "password": "admin123"
}
```

**验证点**:
- [ ] 状态码正确
- [ ] 业务码为0
- [ ] Token格式正确
- [ ] Token可以用于后续请求

---

### TC-AUTH-002: 用户登录失败 - 错误用户名
**优先级**: P0  
**测试类型**: 异常测试

**前置条件**:
- 后端服务正常运行

**测试步骤**:
1. 发送POST请求到 `/api/admin/auth/login`
2. 请求体: `{"username": "wrong_user", "password": "admin123"}`
3. 检查响应

**预期结果**:
- HTTP状态码: 200 (业务错误仍返回200)
- 业务码: 非0
- 错误信息: 包含"用户不存在"或类似提示

**测试数据**:
```json
{
  "username": "wrong_user",
  "password": "admin123"
}
```

**验证点**:
- [ ] 返回错误码
- [ ] 错误信息清晰
- [ ] 不返回token

---

### TC-AUTH-003: 用户登录失败 - 错误密码
**优先级**: P0  
**测试类型**: 异常测试

**测试步骤**:
1. 发送POST请求到 `/api/admin/auth/login`
2. 请求体: `{"username": "admin", "password": "wrong_pass"}`
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 非0
- 错误信息: 包含"密码错误"或类似提示

**验证点**:
- [ ] 返回错误码
- [ ] 错误信息清晰
- [ ] 不返回token

---

### TC-AUTH-004: 用户登录失败 - 缺少参数
**优先级**: P1  
**测试类型**: 异常测试

**测试步骤**:
1. 发送POST请求到 `/api/admin/auth/login`
2. 请求体: `{"username": "admin"}` (缺少password)
3. 检查响应

**预期结果**:
- HTTP状态码: 422 (参数验证错误)
- 错误信息: 提示缺少必需参数

**验证点**:
- [ ] 返回422状态码
- [ ] 错误信息明确

---

### TC-AUTH-005: 获取当前用户信息
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 已成功登录，获得token

**测试步骤**:
1. 设置请求头: `Authorization: Bearer {token}`
2. 发送GET请求到 `/api/admin/auth/me`
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回用户信息:
  - `user_id`: UUID格式
  - `username`: "admin"
  - `role`: "SysAdmin"
  - `contractor_id`: null (系统管理员)

**验证点**:
- [ ] 状态码正确
- [ ] 用户信息完整
- [ ] 字段类型正确

---

### TC-AUTH-006: 获取当前用户信息 - 未认证
**优先级**: P0  
**测试类型**: 异常测试

**测试步骤**:
1. 不设置Authorization头
2. 发送GET请求到 `/api/admin/auth/me`
3. 检查响应

**预期结果**:
- HTTP状态码: 401
- 错误信息: "未认证"或类似提示

**验证点**:
- [ ] 返回401状态码
- [ ] 错误信息清晰

---

### TC-AUTH-007: 获取当前用户信息 - 无效Token
**优先级**: P1  
**测试类型**: 异常测试

**测试步骤**:
1. 设置请求头: `Authorization: Bearer invalid_token`
2. 发送GET请求到 `/api/admin/auth/me`
3. 检查响应

**预期结果**:
- HTTP状态码: 401
- 错误信息: "令牌无效"或类似提示

**验证点**:
- [ ] 返回401状态码
- [ ] 错误信息清晰

---

## 4.2 作业票管理模块

### TC-TICKET-001: 获取作业票列表 - 基础查询
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 已登录，获得token
- 数据库中有作业票数据

**测试步骤**:
1. 设置Authorization头
2. 发送GET请求到 `/api/admin/work-tickets?page=1&page_size=20`
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 响应结构:
  ```json
  {
    "code": 0,
    "data": {
      "items": [...],
      "total": 10,
      "page": 1,
      "page_size": 20
    }
  }
  ```
- `items` 是数组
- `total` 大于0
- 每个item包含必需字段:
  - `ticket_id`: UUID格式
  - `title`: 字符串
  - `contractor_name`: 字符串
  - `status`: 字符串
  - `start_date`: 日期格式
  - `end_date`: 日期格式

**验证点**:
- [ ] 状态码正确
- [ ] 数据结构正确
- [ ] 分页信息正确
- [ ] 数据字段完整

---

### TC-TICKET-002: 获取作业票列表 - 按施工单位筛选
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 已登录
- 数据库中有多个施工单位的作业票

**测试步骤**:
1. 先获取施工单位选项: `GET /api/admin/contractors/options`
2. 选择第一个施工单位ID
3. 发送GET请求: `/api/admin/work-tickets?contractor_id={contractor_id}&page=1&page_size=20`
4. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 所有返回的作业票的 `contractor.contractor_id` 都等于筛选的ID
- 总数应该小于等于全部作业票数量

**测试数据**:
- 使用实际数据库中的contractor_id

**验证点**:
- [ ] 筛选结果正确
- [ ] 所有结果都符合筛选条件
- [ ] 分页信息正确

---

### TC-TICKET-003: 获取作业票列表 - 按状态筛选
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/work-tickets?status=IN_PROGRESS&page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 所有返回的作业票的 `status` 都等于 "IN_PROGRESS"

**验证点**:
- [ ] 筛选结果正确
- [ ] 所有结果状态一致

---

### TC-TICKET-004: 获取作业票列表 - 关键词搜索
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/work-tickets?keyword=焊接&page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 所有返回的作业票的 `title` 包含 "焊接" (不区分大小写)

**验证点**:
- [ ] 搜索结果正确
- [ ] 搜索不区分大小写
- [ ] 支持部分匹配

---

### TC-TICKET-005: 获取作业票列表 - 日期范围筛选
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/work-tickets?start_date=2026-01-09&end_date=2026-01-15&page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 所有返回的作业票的日期范围与查询条件有交集
- `start_date <= end_date` 的作业票会被返回

**验证点**:
- [ ] 日期筛选逻辑正确
- [ ] 边界条件处理正确

---

### TC-TICKET-006: 获取作业票列表 - 组合筛选
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/work-tickets?contractor_id={id}&status=IN_PROGRESS&keyword=焊接&page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 所有结果同时满足所有筛选条件

**验证点**:
- [ ] 组合筛选逻辑正确
- [ ] 所有条件都生效

---

### TC-TICKET-007: 获取作业票列表 - 分页测试
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 获取第一页: `GET /api/admin/work-tickets?page=1&page_size=5`
2. 获取第二页: `GET /api/admin/work-tickets?page=2&page_size=5`
3. 检查响应

**预期结果**:
- 第一页返回5条数据
- 第二页返回剩余数据
- 两页数据不重复
- `total` 字段一致
- `page` 和 `page_size` 正确

**验证点**:
- [ ] 分页逻辑正确
- [ ] 数据不重复
- [ ] 总数正确

---

### TC-TICKET-008: 获取作业票列表 - 边界值测试
**优先级**: P1  
**测试类型**: 边界测试

**测试用例**:
1. `page=0` → 应该返回错误或默认值
2. `page_size=0` → 应该返回错误
3. `page_size=1000` → 应该限制最大数量
4. `page` 超出范围 → 应该返回空数组

**预期结果**:
- 参数验证正确
- 返回合理的错误信息或默认值

**验证点**:
- [ ] 参数验证生效
- [ ] 错误处理合理

---

### TC-TICKET-009: 获取作业票详情
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 已登录
- 数据库中有作业票数据

**测试步骤**:
1. 先获取作业票列表，获取一个ticket_id
2. 发送GET请求: `/api/admin/work-tickets/{ticket_id}`
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回完整的作业票信息:
  - `ticket_id`: 与请求的ID一致
  - `title`: 字符串
  - `description`: 字符串或null
  - `contractor_id`: UUID
  - `contractor_name`: 字符串
  - `start_date`: 日期
  - `end_date`: 日期
  - `status`: 字符串
  - `workers`: 数组
  - `areas`: 数组
  - `videos`: 数组
  - `daily_tickets`: 数组

**验证点**:
- [ ] 返回数据完整
- [ ] 关联数据正确加载
- [ ] 字段类型正确

---

### TC-TICKET-010: 获取作业票详情 - 不存在的ID
**优先级**: P0  
**测试类型**: 异常测试

**测试步骤**:
1. 发送GET请求: `/api/admin/work-tickets/00000000-0000-0000-0000-000000000000`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 非0
- 错误信息: "作业票不存在"或类似提示

**验证点**:
- [ ] 错误处理正确
- [ ] 错误信息清晰

---

### TC-TICKET-011: 创建作业票 - 成功
**优先级**: P0  
**测试类型**: 功能测试

**前置条件**:
- 已登录
- 数据库中有施工单位、区域、视频、人员数据

**测试步骤**:
1. 准备测试数据:
   - 获取一个contractor_id
   - 获取多个worker_id
   - 获取多个area_id
   - 获取多个video_id
2. 发送POST请求: `/api/admin/work-tickets`
3. 请求体包含所有必需字段
4. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回 `ticket_id`
- 数据库中存在新创建的作业票
- 关联数据（workers, areas, videos）已创建

**测试数据**:
```json
{
  "title": "测试作业票",
  "description": "这是一个测试作业票",
  "contractor_id": "uuid",
  "start_date": "2026-01-10",
  "end_date": "2026-01-15",
  "default_access_start_time": "06:00:00",
  "default_access_end_time": "20:00:00",
  "default_training_deadline_time": "07:30:00",
  "worker_ids": ["uuid1", "uuid2"],
  "area_ids": ["uuid1"],
  "video_ids": ["uuid1", "uuid2"],
  "notify_on_publish": true,
  "daily_reminder_enabled": true
}
```

**验证点**:
- [ ] 创建成功
- [ ] 返回ID正确
- [ ] 数据库记录正确
- [ ] 关联数据正确

---

### TC-TICKET-012: 创建作业票 - 缺少必需字段
**优先级**: P0  
**测试类型**: 异常测试

**测试步骤**:
1. 发送POST请求，缺少 `title` 字段
2. 检查响应

**预期结果**:
- HTTP状态码: 422
- 错误信息: 提示缺少必需字段

**验证点**:
- [ ] 参数验证生效
- [ ] 错误信息明确

---

### TC-TICKET-013: 创建作业票 - 日期逻辑错误
**优先级**: P0  
**测试类型**: 异常测试

**测试步骤**:
1. 发送POST请求，`start_date` 晚于 `end_date`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 非0
- 错误信息: "开始日期不能晚于结束日期"

**验证点**:
- [ ] 业务逻辑验证生效
- [ ] 错误信息清晰

---

### TC-TICKET-014: 创建作业票 - 关联数据不存在
**优先级**: P1  
**测试类型**: 异常测试

**测试步骤**:
1. 发送POST请求，使用不存在的 `contractor_id`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 非0
- 错误信息: "施工单位不存在"

**验证点**:
- [ ] 外键验证生效
- [ ] 错误信息清晰

---

## 4.3 施工单位管理模块

### TC-CONTRACTOR-001: 获取施工单位列表
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/contractors?page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回列表数据，每个item包含:
  - `contractor_id`: UUID
  - `name`: 字符串
  - `code`: 字符串
  - `contact_person`: 字符串或null
  - `contact_phone`: 字符串或null
  - `is_active`: 布尔值

**验证点**:
- [ ] 数据结构正确
- [ ] 字段完整

---

### TC-CONTRACTOR-002: 获取施工单位选项
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/contractors/options`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回数组格式:
  ```json
  [
    {
      "id": "uuid",
      "name": "string",
      "contractor_id": "uuid"
    }
  ]
  ```
- 只返回 `is_active=true` 的施工单位

**验证点**:
- [ ] 返回数组格式
- [ ] 字段名称正确（id, name, contractor_id）
- [ ] 只返回活跃的

---

### TC-CONTRACTOR-003: 获取施工单位选项 - 路由顺序验证
**优先级**: P0  
**测试类型**: 功能测试

**说明**: 验证 `/options` 路由在 `/{contractor_id}` 之前定义

**测试步骤**:
1. 发送GET请求: `/api/admin/contractors/options`
2. 确认返回选项列表，而不是404或错误

**预期结果**:
- 路由正确匹配
- 不将 "options" 解析为UUID

**验证点**:
- [ ] 路由匹配正确
- [ ] 不返回404

---

### TC-CONTRACTOR-004: 获取施工单位详情
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 先获取列表，获取一个contractor_id
2. 发送GET请求: `/api/admin/contractors/{contractor_id}`
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回完整的施工单位信息

**验证点**:
- [ ] 数据完整
- [ ] ID匹配

---

### TC-CONTRACTOR-005: 创建施工单位
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 发送POST请求: `/api/admin/contractors`
2. 请求体包含所有必需字段
3. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回 `contractor_id`
- 数据库中存在新记录

**测试数据**:
```json
{
  "name": "测试施工单位",
  "code": "TEST001",
  "contact_person": "张三",
  "contact_phone": "13800138000",
  "address": "测试地址",
  "license_no": "TEST123456",
  "qualification_level": "一级"
}
```

**验证点**:
- [ ] 创建成功
- [ ] 数据正确保存

---

### TC-CONTRACTOR-006: 创建施工单位 - 编码重复
**优先级**: P1  
**测试类型**: 异常测试

**测试步骤**:
1. 使用已存在的 `code` 创建施工单位
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 非0
- 错误信息: "单位编码已存在"

**验证点**:
- [ ] 唯一性验证生效
- [ ] 错误信息清晰

---

## 4.4 区域管理模块

### TC-AREA-001: 获取区域列表
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/areas?page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回区域列表，每个item包含:
  - `area_id`: UUID
  - `name`: 字符串
  - `description`: 字符串或null
  - `site_id`: UUID

**验证点**:
- [ ] 数据结构正确
- [ ] 分页正常

---

## 4.5 视频管理模块

### TC-VIDEO-001: 获取视频列表
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/videos?page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回视频列表，每个item包含:
  - `video_id`: UUID
  - `title`: 字符串
  - `duration_sec`: 整数
  - `file_url`: 字符串或null

**验证点**:
- [ ] 数据结构正确
- [ ] 字段完整

---

## 4.6 人员管理模块

### TC-WORKER-001: 获取人员列表
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/workers?page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回人员列表，每个item包含:
  - `worker_id`: UUID
  - `name`: 字符串
  - `phone`: 字符串
  - `id_card_no`: 字符串或null
  - `is_active`: 布尔值

**验证点**:
- [ ] 数据结构正确
- [ ] 分页正常

---

## 4.7 报表统计模块

### TC-REPORT-001: 获取Dashboard数据
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/reports/dashboard`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 响应结构:
  ```json
  {
    "code": 0,
    "data": {
      "stats": {
        "todayTasks": 0,
        "activeTickets": 0,
        "todayTrainings": 0,
        "accessGrants": 0,
        "syncRate": 0
      },
      "pendingTickets": [],
      "recentAlerts": []
    }
  }
  ```
- `stats` 对象存在
- `pendingTickets` 是数组
- `recentAlerts` 是数组

**验证点**:
- [ ] 数据结构符合前端期望
- [ ] 所有必需字段存在
- [ ] 字段类型正确

---

### TC-REPORT-002: 获取Dashboard数据 - 字段类型验证
**优先级**: P0  
**测试类型**: 数据验证

**测试步骤**:
1. 获取Dashboard数据
2. 验证每个字段的类型

**预期结果**:
- `stats.todayTasks`: 整数 >= 0
- `stats.activeTickets`: 整数 >= 0
- `stats.todayTrainings`: 整数 >= 0
- `stats.accessGrants`: 整数 >= 0
- `stats.syncRate`: 数字 >= 0 且 <= 100
- `pendingTickets`: 数组
- `recentAlerts`: 数组

**验证点**:
- [ ] 所有字段类型正确
- [ ] 数值范围合理

---

### TC-REPORT-003: 获取培训进度报告
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/reports/training-progress`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回培训进度数据

**验证点**:
- [ ] 数据格式正确
- [ ] 统计准确

---

### TC-REPORT-004: 获取对账报告
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/reports/reconciliation`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回对账数据

**验证点**:
- [ ] 数据格式正确
- [ ] 统计准确

---

## 4.8 告警管理模块

### TC-ALERT-001: 获取告警统计
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/alerts/stats?status=UNACKNOWLEDGED`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 响应结构:
  ```json
  {
    "code": 0,
    "data": {
      "total": 0,
      "unacknowledged": 0,
      "acknowledged": 0,
      "resolved": 0,
      "high": 0,
      "medium": 0,
      "low": 0
    }
  }
  ```
- 所有字段都是整数 >= 0

**验证点**:
- [ ] 数据结构正确
- [ ] 字段完整
- [ ] 字段类型正确

---

### TC-ALERT-002: 获取告警统计 - 不同状态参数
**优先级**: P1  
**测试类型**: 功能测试

**测试用例**:
1. `status=UNACKNOWLEDGED` → 返回未确认统计
2. `status=ACKNOWLEDGED` → 返回已确认统计
3. `status=RESOLVED` → 返回已解决统计
4. 无status参数 → 返回全部统计

**预期结果**:
- 根据status参数返回对应统计
- 无参数时返回全部统计

**验证点**:
- [ ] 参数处理正确
- [ ] 统计准确

---

### TC-ALERT-003: 获取告警列表
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 发送GET请求: `/api/admin/alerts?page=1&page_size=20`
2. 检查响应

**预期结果**:
- HTTP状态码: 200
- 业务码: 0
- 返回列表结构:
  ```json
  {
    "code": 0,
    "data": {
      "items": [],
      "total": 0,
      "page": 1,
      "page_size": 20
    }
  }
  ```

**验证点**:
- [ ] 数据结构正确
- [ ] 分页信息正确

---

## 4.9 前端功能测试

### TC-FRONTEND-001: 登录页面正常显示
**优先级**: P0  
**测试类型**: UI测试

**测试步骤**:
1. 访问 `http://localhost:5173/login`
2. 检查页面元素

**预期结果**:
- 页面正常加载
- 显示用户名输入框
- 显示密码输入框
- 显示登录按钮
- 无JavaScript错误

**验证点**:
- [ ] 页面元素完整
- [ ] 样式正常
- [ ] 无控制台错误

---

### TC-FRONTEND-002: 登录功能正常
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 在登录页面输入用户名和密码
2. 点击登录按钮
3. 检查跳转和状态

**预期结果**:
- 登录成功
- 跳转到Dashboard页面
- 用户信息正确显示
- Token正确保存

**验证点**:
- [ ] 登录流程正常
- [ ] 状态管理正确
- [ ] 路由跳转正确

---

### TC-FRONTEND-003: Dashboard页面数据加载
**优先级**: P0  
**测试类型**: 集成测试

**测试步骤**:
1. 登录后访问Dashboard页面
2. 检查数据加载

**预期结果**:
- 页面正常加载
- 统计数据正确显示
- 图表正常渲染
- 无404错误
- 无控制台错误

**验证点**:
- [ ] API调用成功
- [ ] 数据正确显示
- [ ] 无错误提示

---

### TC-FRONTEND-004: 作业票列表页面数据加载
**优先级**: P0  
**测试类型**: 集成测试

**测试步骤**:
1. 访问作业票列表页面
2. 检查数据加载

**预期结果**:
- 页面正常加载
- 列表数据正确显示
- 分页控件正常
- 无404错误

**验证点**:
- [ ] API调用成功
- [ ] 数据正确显示
- [ ] 分页功能正常

---

### TC-FRONTEND-005: 筛选功能 - 施工单位选择
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 在作业票列表页面
2. 选择施工单位下拉框
3. 选择一个施工单位
4. 检查列表更新

**预期结果**:
- 下拉框正常显示选项
- 选择后自动触发搜索（不需要点击搜索按钮）
- 列表自动更新
- 只显示选中施工单位的作业票

**验证点**:
- [ ] 自动搜索生效
- [ ] 筛选结果正确
- [ ] UI响应及时

---

### TC-FRONTEND-006: 筛选功能 - 状态选择
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 在作业票列表页面
2. 选择状态下拉框
3. 选择一个状态（如"进行中"）
4. 检查列表更新

**预期结果**:
- 选择后自动触发搜索
- 列表自动更新
- 只显示选中状态的作业票

**验证点**:
- [ ] 自动搜索生效
- [ ] 筛选结果正确

---

### TC-FRONTEND-007: 筛选功能 - 关键词搜索
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 在作业票列表页面
2. 在关键词输入框输入"焊接"
3. 点击搜索按钮
4. 检查列表更新

**预期结果**:
- 搜索按钮正常响应
- 列表更新
- 只显示标题包含"焊接"的作业票

**验证点**:
- [ ] 搜索功能正常
- [ ] 结果正确

---

### TC-FRONTEND-008: 筛选功能 - 重置
**优先级**: P1  
**测试类型**: 功能测试

**测试步骤**:
1. 设置多个筛选条件
2. 点击重置按钮
3. 检查筛选条件

**预期结果**:
- 所有筛选条件清空
- 列表恢复到初始状态
- 显示所有数据

**验证点**:
- [ ] 重置功能正常
- [ ] 条件清空正确

---

### TC-FRONTEND-009: 分页功能
**优先级**: P0  
**测试类型**: 功能测试

**测试步骤**:
1. 在作业票列表页面
2. 点击下一页
3. 检查数据更新

**预期结果**:
- 页码正确更新
- 显示对应页的数据
- 数据不重复
- 总数正确

**验证点**:
- [ ] 分页逻辑正确
- [ ] 数据正确

---

### TC-FRONTEND-010: 告警统计显示
**优先级**: P0  
**测试类型**: 集成测试

**测试步骤**:
1. 访问Dashboard或MainLayout
2. 检查告警统计API调用
3. 检查控制台

**预期结果**:
- API调用成功（200状态码）
- 无404错误
- 无控制台错误
- 统计数据正确显示（如果有UI显示）

**验证点**:
- [ ] API调用成功
- [ ] 无错误
- [ ] 数据正确

---

## 5. 测试执行计划

### 5.1 测试阶段划分

#### 阶段1: 单元测试（开发阶段）
- **时间**: 开发过程中
- **范围**: 单个API端点
- **执行**: 开发人员
- **工具**: pytest

#### 阶段2: 集成测试（功能完成后）
- **时间**: 功能开发完成后
- **范围**: 前后端集成
- **执行**: 测试人员
- **工具**: pytest + 手动测试

#### 阶段3: 系统测试（发布前）
- **时间**: 发布前1周
- **范围**: 完整业务流程
- **执行**: 测试团队
- **工具**: 自动化测试 + 手动测试

### 5.2 测试优先级

- **P0**: 必须测试，阻塞发布
- **P1**: 重要测试，建议测试
- **P2**: 可选测试，有时间再测

### 5.3 测试执行顺序

1. **认证授权模块** (P0) - 所有其他功能的基础
2. **作业票管理模块** (P0) - 核心功能
3. **报表统计模块** (P0) - Dashboard依赖
4. **告警管理模块** (P0) - 前端依赖
5. **其他管理模块** (P1)
6. **前端功能测试** (P0)

---

## 6. 测试报告模板

### 6.1 测试执行记录

| 用例编号 | 用例名称 | 优先级 | 执行结果 | 执行时间 | 备注 |
|---------|---------|--------|---------|---------|------|
| TC-AUTH-001 | 用户登录成功 | P0 | ✅ PASS | 2026-01-10 | |
| TC-AUTH-002 | 用户登录失败-错误用户名 | P0 | ✅ PASS | 2026-01-10 | |
| ... | ... | ... | ... | ... | ... |

### 6.2 Bug记录

| Bug编号 | 用例编号 | 严重程度 | Bug描述 | 状态 | 修复时间 |
|---------|---------|---------|---------|------|---------|
| BUG-001 | TC-TICKET-001 | 高 | API路径不匹配 | ✅ 已修复 | 2026-01-09 |
| ... | ... | ... | ... | ... | ... |

### 6.3 测试总结

- **总用例数**: XX
- **执行用例数**: XX
- **通过用例数**: XX
- **失败用例数**: XX
- **阻塞用例数**: XX
- **通过率**: XX%

---

## 7. 测试工具和脚本

### 7.1 自动化测试脚本

- **位置**: `tests/test_api.py`
- **运行**: `python tests/run_tests.py`
- **覆盖**: 所有API端点

### 7.2 前端测试脚本

- **位置**: `tests/test_frontend.py`
- **运行**: `python tests/test_frontend.py`
- **覆盖**: API调用和筛选功能

### 7.3 测试数据初始化

- **脚本**: `backend/scripts/init_demo_data.py`
- **运行**: `python backend/scripts/init_demo_data.py`
- **作用**: 初始化测试数据

---

## 8. 测试维护

### 8.1 用例更新
- 新增功能时，必须添加对应测试用例
- 修改功能时，必须更新对应测试用例
- 删除功能时，必须删除对应测试用例

### 8.2 用例评审
- 每个迭代开始前，评审测试用例
- 确保用例覆盖所有功能点
- 确保用例可执行

### 8.3 测试报告
- 每次测试执行后，生成测试报告
- 记录所有Bug和问题
- 跟踪Bug修复状态

---

**文档版本**: v2.0  
**最后更新**: 2026-01-10  
**维护者**: 测试团队

